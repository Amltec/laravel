@php
use App\Models\Base\ProcessRobot;

exit('negado - já utilizado');
echo '<style>body{white-space:pre;font-family:monospace;}</style>';


$dates=[
    '1'=>['2020-02-01','2020-05-31'],
    '2'=>['2020-06-01','2020-06-30'],
    '3'=>['2020-07-01','2020-07-31'],
    '4'=>['2020-08-01','2020-08-31'],
    '5'=>['2020-09-01','2020-09-30'],
];

$X=_GET('x');
//if(!$X)exit('parâmetro incorreto');

//*** Todos os registros finalizados de 28/02/2020 até 30/09/2020 - esperados 13149 registros ***
$regs = (new ProcessRobot)->where('process_status','f')
    //->whereDate('created_at','>=', $dates[$X][0] )
    //->whereDate('created_at','<=', $dates[$X][1] )
    ->whereIn('id',[24867,24868,24869,24877,24878,24879,24882,24884,24891,24892,24893,24894,24895,24896,24897,24898,24900,24901,24902,24903,24905,24907,24908,24909,24910,24912,24913,24914,24915,24972,24974,24976,24994,24996,24997,24998,25003,25006,25007,25011,25013,25016,25018,25027,25029,25031,25032,25036,25040,25042,25043,25044,25045,25046,25049,25050,25051,25052,25053,25054,25056,25057,25058,25059,25060,25061,25062,25063,25065,25066,25067,25068,25069,25070,25072,25074,25075,25076,25077,25078,25080,25081,25094,25095,25096,25103,25119,25120,25122,25123,25128,25131,25133,25134,25135,25136,25137,25138,25139,25141,25142,25155,25164,25168,25188,25194,25195,25196,25198,25199,25201,25202,25203,25204,25205,25206,25207,25208,25210,25211,25212,25213,25214,25215,25216,25217,25218,25219,25220,25221,25222,25224,25225,25226,25227,25228,25229,25230,25231,25232,25233,25234,25235,25236,25237,25238,25239,25240,25241,25242,25243,25244,25245,25246,25248,25250,25252,25253,25254,25255,25256,25257,25258,25259,25260,25261,25262,25263,25264,25266,25267,25268,25269,25270,25271,25272,25273,25274,25275,25276,25277,25278,25279,25280,25281,25282,25283,25284,25285,25286,25287,25288,25289,25290,25291,25292,25293,25295,25296,25298,25299,25300,25301,25302,25303,25304,25305,25306,25307,25308,25310,25311,25312,25313,25314,25315,25317,25318,25319,25320,25322,25323,25324,25325,25327,25328,25329,25331,25332,25333,25334,25335,25336,25337,25338,25339,25340,25341,25342,25343,25344,25345,25347,25348,25349,25350,25351,25352,25353,25354,25355,25356,25357,25358,25360,25363,25364,25365,25366,25367,25368,25370,25371,25372,25373,25378,25379,25380,25383,25385,25386,25387,25388,25389,25390,25392,25395,25396,25397,25398,25399,25400,25402,25403,25406,25407,25408,25409,25410,25411,25412,25414,25415,25416,25417,25419,25420,25421,25423,25424,25425,25427,25430,25431,25432,25435,25436,25437,25438,25441,25442,25443,25445,25446,25447,25448,25451,25452,25453,25455,25456,25457,25458,25459,25460,25461,25462,25463,25464,25465,25466,25467,25469,25470,25472,25474,25475,25476,25477,25478,25479,25480,25484,25485,25486,25487,25489,25490,25492,25493,25494,25495,25496,25497,25498,25499,25500,25501,25502,25503,25504,25505,25507,25509,25510,25511,25512,25513,25514,25515,25516,25517,25519,25520,25521,25522,25523,25524,25525,25527,25528,25530,25531,25533,25534,25537,25538,25539,25541,25542,25544,25546,25547,25548,25549,25550,25551,25552,25554,25555,25556,25557,25558,25559,25560,25561,25566,25567,25569,25570,25571,25572,25573,25574,25575,25576,25580,25582,25583,25585,25586,25588,25590,25591,25594,25595,25596,25597,25599,25600,25601,25602,25605,25606,25607,25609,25610,25614,25616,25618,25626,25629,25630,25631,25632,25639,25669,25670,25671,25672,25673,25674,25675,25676,25677,25678,25679,25680,25681,25682,25683,25684,25685,25686,25687,25688,25690,25691,25692,25693,25695,25696,25702,25703,25713,25716,25717,25718,25720,25722,25727,25728,25729,25731,25740,25741,25742,25743,25758,25761,25763,25764,25765,25766,25767,25768,25769,25771,25773,25774,25777,25778,25780,25781,25783,25786,25787,25788,25789,25791,25792,25793,25794,25796,25797,25798,25800,25801,25802,25803,25804,25806,25807,25809,25810,25812,25813,25814,25815,25816,25817,25819,25821,25825,25827,25828,25830,25832,25833,25834,25835,25836,25837,25838,25839,25841,25842,25843,25844,25845,25847,25849,25850,25860,25866,25867,25868,25872,25908,25909,25910,25911,25912,25913,25914,25915,25916,25917,25918,25919,25920,25921,25923,25924,25926,25927,25949,25951,25952,25953,25954,25955,25956,25958,25959,25960,25962,25963,25964,25965,25966,25968,25969,25970,25971,25973,25974,25975,25976,25977,25978,25979,25981,25982,25984,25986,25987,25988,25989,25990,25991,25993,25994,25997,25999,26000,26001,26002,26003,26005,26006,26007,26008,26009,26010,26011,26012,26013,26014,26015,26016,26017,26018,26019,26020,26021,26022,26023,26024,26025,26026,26027,26030,26031,26032,26033,26035,26036,26037,26038,26039,26041,26042,26055,26056,26057,26058,26059,26060,26061,26062,26063,26064,26065,26066,26067,26068,26069,26070,26071,26076,26077,26084,26085,26086,26087,26089,26092,26093,26096,26098,26099,26100,26103,26104,26106,26108,26111,26113,26114,26115,26116,26117,26118,26119,26120,26121,26122,26123,26124,26125,26126,26127,26128,26129,26130,26132,26134,26135,26136,26137,26139,26141,26142,26143,26144,26145,26146,26147,26148,26151,26153,26155,26156,26158,26159,26163,26166,26168,26169,26170,26171,26172,26174,26175,26176,26178,26179,26180,26183,26184,26185,26186,26187,26188,26189,26190,26191,26192,26193,26194,26195,26196,26197,26199,26200,26201,26202,26203,26204,26206,26207,26209,26210,26211,26212,26214,26215,26217,26218,26219,26220,26223,26224,26225,26226,26227,26229,26233,26235,26236,26237,26238,26240,26241,26246,26248,26249,26250,26279,26295,26302,26308,26310,26316,26322,26329,26330,26331,26332,26333,26334,26335,26336,26341,26342,26343,26344,26345,26346,26347,26348,26349,26350,26351,26352,26353,26354,26355,26356,26357,26358,26359,26360,26361,26362,26363,26365,26367,26368,26372,26373,26374,26375,26376,26377,26378])
    ->get();
echo 'id;cadastro;vig_inicial;vig_final;dias'. PHP_EOL;
foreach($regs as $reg){
    $data = $reg->getText('data');
    $vi = $data['inicio_vigencia']??'';
    $vf = $data['termino_vigencia']??'';
    
    if($vi && $vf){
        $days = FormatUtility::dateDiffFull($vi,$vf,'d1');

        if(!in_array($days,[365,366])){
            echo $reg->id .';'. date_format($reg->created_at,'d/m/Y') .';'. $vi .';'. $vf .';'. $days . PHP_EOL;
        }
    }else if(empty($vf)){
        echo $reg->id .';'. date_format($reg->created_at,'d/m/Y') .';'. $vi .';'. $vf .';'. '' . PHP_EOL;
    }
}

@endphp